syntax = "proto3";

package aruna.api.v3;

import "models.proto";

service AuthService {
  rpc Authorize(AuthorizeRequest) returns (AuthorizeResponse) {}
}

message AuthorizeRequest {
  string token = 1;
  repeated string resource_ids = 2;
  aruna.api.v3.Permission permission = 3;
  string current_state = 4;
}

message AuthorizeResponse {
  bool authorized = 1;
  string message = 2;
  bool should_update = 3;
}