syntax = "proto3";

package services;
option go_package = "github.com/ScienceObjectsDB/go-api/services";
option java_multiple_files = true;
option java_package = "com.github.ScienceObjectsDB.java_api.services";
option java_outer_classname = "DatasetObjectsServiceModels";

import "api/models/CommonModels.proto";
import "api/models/ObjectModels.proto";
import "protoc/gateway/options/annotations.proto";


message CreateObjectGroupWithRevisionRequest {
    option (grpc.gateway.protoc_gen_swagger.options.openapiv2_schema) = {
        json_schema: {
            title: "ObjectGroup";
            description: "Tracks the change history of an object group."
        };
    };

    CreateObjectGroupRequest object_group = 1;
    CreateObjectGroupRevisionRequest object_group_version = 2;
}

message CreateObjectGroupRequest {
    string name = 1;
    string dataset_id = 2;
    repeated models.Label labels = 3;
    repeated models.Metadata metadata = 4;
}

message AddRevisionToObjectGroupRequest {
    string object_group_id = 1;
    CreateObjectGroupRevisionRequest group_version = 2;
}

message CreateObjectGroupRevisionRequest {
    repeated CreateObjectRequest objects = 4;
    repeated models.Label labels = 5;
    repeated models.Metadata metadata = 6;
}

message CreateObjectRequest {
    string filename = 1;
    string filetype = 2;
    repeated models.Label labels = 3;
    repeated models.Metadata metadata = 4;
    int64 content_len = 5; // ContentLen: Lenght of the stored dataset
    models.Origin origin = 6; // Origin: Source of the dataset
}

enum ObjectGroupRevisionReferenceType {
    Version = 0;
    Revision = 1;
}

message GetObjectGroupRevisionRequest {
    ObjectGroupRevisionReferenceType reference_type = 1;
    string revision = 2;
    models.Version version = 3;
}

message GetObjectGroupRevisionResponse {
    models.ObjectGroup object_group = 1;
    models.ObjectGroupRevision object_group_revision = 2;
}

message ObjectGroupRevisions {
    repeated models.ObjectGroupRevision object_group_revision = 2;
}